## 实验五：生成网络图像编辑

### 实验任务

1. 使用一个gan网络对一张你自己的图像（推荐人脸照片）进行编辑

### 实验内容

1. 复现一个GAN（推荐stylegan，这个比较好用一点），确保可以用stylegan的生成1024x1024图像的功能。
2. 选择一种合适的编码器（Encoder），提示：可以用上个实验的预训练CLIP作为Encoder，用这个编码器将图像变为Embedding
3. 将图像Embedding送入stylegan中，通过控制空间编码的参数，进行一些有趣的修改

### 实验要求

1. 实验报告在内容上必须要介绍实验环境（操作系统、CPU/GPU的型号、torch版本）。请重点介绍实验任务过程和实验结果，避免粘贴大段代码。注意，请不要剽窃他人的报告或代码。
2. 本次实验重视代码解释，需要在报告中附上清晰的原理解释，包括风格化如何生效、模型对图像进行改动的原理、以及模型的结构等都必须清楚的讲解。
3. 如果你喜欢的话，可以多做几组编辑，探索一下不同的参数会带来什么风格化的结果，如果讲解清晰，逻辑完整，实验充分的话可获得加分。

### 关于GAN的一些知识

gan是一个比较难以训练的网络，因此本次实验不要求大家一定要训练出自己的gan来，只需使用网上现成的参数即可，但需在报告中详细解释原理。

生成对抗网络（GAN）是一种深度学习架构。该架构训练两个神经网络相互竞争，从而从给定的训练数据集生成更真实的新数据。例如，可以从现有图像数据库生成新图像，也可以从歌曲数据库生成原创音乐。GAN 之所以被称为对抗网络，是因为该架构训练两个不同的网络并使其相互对抗。一个网络通过获取输入数据样本并尽可能对其进行修改来生成新数据。另一个网络尝试预测生成的数据输出是否属于原始数据集。换句话说，预测网络决定生成的数据是假的还是真的。系统会生成更新、改进版本的假数据值，直到预测网络不再能够区分假数据值和原始数据值。

用训好的gan进行图像编辑会产生较好的效果，图像的风格和背景都可以被方便的改变。

生成对抗网络系统包括两个深度神经网络 — Generator网络和Discriminator网络。这两个网络在对抗性中轮流被训练，其中一个网络尝试生成新数据，另一个网络尝试预测输出是虚假数据还是真实数据。

从技术上讲，GAN 的工作原理由复杂的数学方程式构成整个计算过程的基础，以下是其简单的概述：

Generator神经网络分析训练集并识别数据属性
Discriminator神经网络分析初始训练数据并独立区分属性
Generator通过向某些属性添加噪点（或随机变化）来修改某些数据属性
Generator将修改后的数据传递给Discriminator
Discriminator计算生成的输出属于原始数据集的概率
Discriminator为Generator提供了一些指导，以减少下一个周期中的噪点向量随机化

Generator尝试最大限度地提高Discriminator出错的可能性，而Discriminator会尝试最大限度地降低出错的可能性。在训练迭代中，Generator和Discriminator会不断演变并相互对抗，直到它们达到平衡状态。在平衡状态下，Discriminator无法再识别合成数据。至此，训练过程结束。

### 补充：模式坍塌（Model Collapse）
模式坍塌是一种在GAN的训练过程中非常常见的现象。有时，Generator和Discriminator设计的不是非常好，可能会出现Generator发现了某一种范式生成的非常好，而Discrimintor因为生成的东西具备很好的质量，并不能分辨其真伪。在这时，双方都会陷入停滞状态，因为Generator无法继续学习更多的范式了，只需一直生成此种范式，就能拿到很好的反馈，同样的，Generator无法见到其他的范式对应的生成物，就不能学习分辨其他范式的知识。此种情况称为模式坍塌。